# IRC-IoT-Malware-Detection

The security, or better insecurity, of IoT devices represents a severe threat to millions of people. Devices are very hard to defend, and very easy to attack, usually ending up as part of a Botnet network that in turn attacks other devices in the world. In the past years, the IRC protocol has been re-discovered as the main Command and Control protocol for IoT botnets. IRC is an old and well-known protocol, but it has not been studied in terms of IoT malware. This thesis aims to study the problem of identification and classification of IoT botnets that use the IRC protocol.
Our proposal to detect IRC traffic in the network has two main parts. First, we present a machine learning detection based on what we call 3-tuple IRC sessions. An IRC 3-tuple session is defined as a group of flows between a source IP address, a destination IP address, and a destination port. 3-tuples allow us to get together all the IRC to the same server. The machine learning model resulted in a $95,24$\% F1-score. Second, we propose a technique that analyzes the characteristics of IRC channels and IRC users and applies machine learning for detection. This technique studies certain features of IRC channels, such as entropy of the messages, and features of IRC users, such as diversity of their messages, in order to find malicious IRC traffic. Our machine learning model on IRC channels showed an $80$\% F1-score and the one on IRC users showed a $66.67$\% F1-score. A new dataset was designed and created to include real IRC traffic from malware executions and benign IRC traffic from a large University. Finally, a comparison against the state-of-the-art IDS Snort and Suricata was done to verify that our technique was sound. All the code of the detectors was published as a new public Zeek module and as a module for the Slips system (Stratosphere Linux IPS).

